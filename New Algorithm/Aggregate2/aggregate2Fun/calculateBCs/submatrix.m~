%% Funcion submatrix
%  Crea una submatriz de la matriz P, de acuerdo con la
%  forma del vector booleano v. Se conserva los elementos
% del tipo e(v(i),v(j)) donde v(i),v(j) = 1.

function [subP,subPi] = submatrix(v)
    % Declaracion de variables globales.
    global l;
    global Q;
    global pi;
    % Se calcula la cantidad de 1's en v
    nOnes = sum(v);
    % Se crea la submatriz, inicialmente en 0
    subP = zeros(nOnes);
    % Se crea la sub distribucion, inicialmente en 0
    subPi = zeros(1,nOnes);
    % Indices para subP
    n = 1;
    m = 1;
    % Se recorre la matriz original
    for i=1:l
        if v(i)==1
            for j=1:l
                if v(j)==1
                    subP(n,m) = Q(i,j);
                    m=m+1;
                end
            end
            subPi(n) = pi(i);
            n=n+1;
            m=1;
        end
    end
end
